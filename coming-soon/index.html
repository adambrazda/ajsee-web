<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title data-i18n-key="comingSoon.title">Čekací listina AJSEE</title>
  <meta name="description" content="Přidej se na čekací listinu AJSEE a získej pozvánku do předprodeje.">
  <link rel="icon" href="/images/logo-ajsee.png"/>
  <style>
    :root{--bg:#f6faff;--card:#ffffff;--ink:#0d2235;--muted:#4a6074;--accent:#0b74e5;--accent2:#085ab5}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial}
    .wrap{max-width:860px;margin:40px auto;padding:0 16px}
    .brand{display:flex;align-items:center;gap:10px;margin-bottom:18px}
    .brand img{width:28px;height:28px}
    .card{background:var(--card);border:1px solid rgba(8,60,130,.08);border-radius:16px;box-shadow:0 18px 50px rgba(8,60,130,.08);padding:24px}
    h1{font-size:clamp(24px,3.4vw,34px);margin:0 0 8px;font-weight:900}
    p.lead{color:var(--muted);margin:0 0 18px}
    form{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center}
    label{font-weight:700}
    input[type=email]{width:100%;padding:12px 14px;border-radius:12px;border:1px solid rgba(8,60,130,.18);outline:0}
    input[type=email]:focus{border-color:#9ec7ff;box-shadow:0 0 0 4px rgba(158,199,255,.25)}
    button[type=submit]{padding:12px 18px;border-radius:999px;background:var(--accent);color:#fff;border:0;font-weight:800;cursor:pointer;white-space:nowrap;box-shadow:0 10px 22px rgba(11,116,229,.28)}
    button[type=submit]:hover{background:var(--accent2)}
    .consent{grid-column:1/-1;display:flex;gap:10px;align-items:flex-start;color:var(--muted);font-size:.95rem}
    .help{grid-column:1/-1;color:var(--muted);font-size:.9rem}
    .back{display:inline-block;margin-top:16px;color:var(--accent);text-decoration:none;font-weight:700}
    @media(max-width:560px){form{grid-template-columns:1fr} button[type=submit]{width:100%}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brand"><img src="/images/logo-ajsee.png" alt="" /><strong>AJSEE</strong></div>
    <div class="card" role="main">
      <h1 data-i18n-key="comingSoon.title">Čekací listina AJSEE</h1>
      <p class="lead" data-i18n-key="comingSoon.lead">Zanech e-mail a pošleme ti pozvánku do předprodeje. Bez spamu.</p>

      <form name="ajsee_waitlist" method="POST" data-netlify="true" netlify-honeypot="bot-field" action="/coming-soon/thanks.html">
        <input type="hidden" name="form-name" value="ajsee_waitlist"/>
        <input type="hidden" name="utm_source" id="utm_source"/>
        <input type="hidden" name="utm_medium" id="utm_medium"/>
        <input type="hidden" name="utm_campaign" id="utm_campaign"/>
        <input type="hidden" name="lang" id="lang"/>

        <label for="email" data-i18n-key="comingSoon.emailLabel">E-mail</label>
        <div></div>
        <input id="email" name="email" type="email" required placeholder="tvuj@email.cz" data-i18n-placeholder="comingSoon.emailPh"/>
        <button type="submit" data-i18n-key="comingSoon.submit">Přidat se na čekací listinu</button>

        <div class="consent">
          <input id="consent" type="checkbox" required/>
          <label for="consent" data-i18n-key="comingSoon.consent">Souhlasím se zpracováním e-mailu…</label>
        </div>
        <div class="help" data-i18n-key="comingSoon.hint">Double opt-in zapnutý. Odhlášení kdykoli.</div>
      </form>

      <a class="back" href="/?lang=cs" data-i18n-key="comingSoon.back">Zpět na web</a>
    </div>
  </div>

  <!-- i18n bootstrapper: naváže se na jazyk stránky/parametr ?lang, natáhne /locales/{lang}.json a aplikuje texty -->
  <script>
    (function () {
      const SUPPORTED = ['cs','en','de','sk','pl','hu'];
      const qs = new URLSearchParams(location.search);

      // 1) Urči jazyk: ?lang -> <html lang> -> 'cs'
      let lang = (qs.get('lang') || '').toLowerCase();
      if (!SUPPORTED.includes(lang)) lang = (document.documentElement.getAttribute('lang') || '').toLowerCase();
      if (!SUPPORTED.includes(lang)) lang = 'cs';
      document.documentElement.setAttribute('lang', lang);

      // 2) Propaguj jazyk do hidden pole, action a „Zpět na web“
      const langInput = document.getElementById('lang');
      if (langInput) langInput.value = lang;

      const form = document.forms['ajsee_waitlist'] || document.querySelector('form[name="ajsee_waitlist"]');
      if (form && form.action) {
        const u = new URL(form.action, location.origin);
        u.searchParams.set('lang', lang);
        form.action = u.pathname + '?' + u.searchParams.toString();
      }
      const backLink = document.querySelector('.back');
      if (backLink) {
        const href = backLink.getAttribute('href') || '/';
        const u = new URL(href, location.origin);
        u.searchParams.set('lang', lang);
        backLink.setAttribute('href', u.pathname + '?' + u.searchParams.toString());
      }

      // 3) Přenes UTM hodnoty do hidden polí
      ['utm_source','utm_medium','utm_campaign'].forEach(k=>{
        const el = document.getElementById(k);
        if (el) el.value = qs.get(k) || '';
      });

      // 4) Načti překlady a aplikuj data-i18n-* na této stránce
      fetch(`/locales/${lang}.json`, { cache: 'no-store' })
        .then(r => r.ok ? r.json() : null)
        .then(dict => {
          if (!dict) return;
          const get = (path) => {
            try { return path.split('.').reduce((o, k) => (o && typeof o === 'object' ? o[k] : undefined), dict); }
            catch { return undefined; }
          };

          // textContent
          document.querySelectorAll('[data-i18n-key]').forEach(el => {
            const key = el.getAttribute('data-i18n-key');
            const v = get(key);
            if (typeof v === 'string') el.textContent = v;
          });

          // alt / placeholder / aria-label
          document.querySelectorAll('[data-i18n-alt]').forEach(el => {
            const key = el.getAttribute('data-i18n-alt');
            const v = get(key);
            if (typeof v === 'string') el.setAttribute('alt', v);
          });
          document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
            const key = el.getAttribute('data-i18n-placeholder');
            const v = get(key);
            if (typeof v === 'string') el.setAttribute('placeholder', v);
          });
          document.querySelectorAll('[data-i18n-aria]').forEach(el => {
            const key = el.getAttribute('data-i18n-aria');
            const v = get(key);
            if (typeof v === 'string') {
              el.setAttribute('aria-label', v);
              el.setAttribute('title', v);
            }
          });

          // <title>
          const titleEl = document.querySelector('title[data-i18n-key]');
          if (titleEl) {
            const key = titleEl.getAttribute('data-i18n-key');
            const v = get(key);
            if (typeof v === 'string') titleEl.textContent = v;
          }
        })
        .catch(() => {});
    })();
  </script>
</body>
</html>
