# netlify.toml

[build]
  command = "npm run build"
  publish = "dist"

[functions]
  directory = "netlify/functions"
  node_bundler = "esbuild"

# CORS pro Functions
[[headers]]
  for = "/.netlify/functions/*"
  [headers.values]
    Access-Control-Allow-Origin = "*"
    Access-Control-Allow-Methods = "GET, POST, OPTIONS"
    Access-Control-Allow-Headers = "Origin, X-Requested-With, Content-Type, Accept, Authorization"

# DEV: Vite přes Netlify Dev (reverse proxy na běžící Vite)
[dev]
  command    = "npm run dev -- --port 5173 --strictPort"
  port       = 8888
  targetPort = 5173
  framework  = "vite"
  autoLaunch = false

# SPA fallback pouze v produkci (v dev proxy necháváme čisté)
[context.production]
  [[context.production.redirects]]
    from = "/*"
    to   = "/index.html"
    status = 200
